<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:mobile.Models"
             x:Class="mobile.Controls.MessageCenterView"
             x:Name="Root"
             WidthRequest="400"
             MaximumHeightRequest="600">
    
    <Border BackgroundColor="{DynamicResource CardBackgroundColor}"
            StrokeThickness="3"
            Stroke="{DynamicResource BorderColor}"
            StrokeShape="RoundRectangle 24"
            Padding="0">
        
        <Border.Shadow>
            <Shadow Brush="{DynamicResource ShadowColor}" 
                    Opacity="0.2" 
                    Radius="20" 
                    Offset="0,8" />
        </Border.Shadow>
        
        <Grid RowDefinitions="Auto,*,Auto">
            
            <!-- Header -->
            <Border Grid.Row="0"
                    BackgroundColor="{DynamicResource PageBackgroundColor}"
                    Padding="20,16"
                    StrokeShape="RoundRectangle 12,12,0,0"
                    StrokeThickness="0">
                
                <Grid ColumnDefinitions="*,Auto,Auto">
                    <Label Text="Messages"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextDecorations="Underline"
                           TextColor="{DynamicResource PrimaryTextColor}"
                           VerticalOptions="Center"/>
                    
                    <Button Grid.Column="1"
                            Text="Tout marquer comme lu"
                            FontSize="12"
                            TextColor="{DynamicResource AccentColor}"
                            BackgroundColor="Transparent"
                            Padding="8,4"
                            Margin="0,0,8,0"
                            Clicked="OnMarkAllAsReadClicked"
                            IsVisible="{Binding HasUnreadMessages, Source={x:Reference Root}}"/>
                    
                    <!-- Bouton fermer -->
                    <Button Grid.Column="2"
                            Text="âœ•"
                            FontSize="18"
                            TextColor="{DynamicResource TertiaryTextColor}"
                            BackgroundColor="Transparent"
                            Padding="8"
                            WidthRequest="36"
                            HeightRequest="36"
                            VerticalOptions="Center"
                            Clicked="OnCloseClicked"/>
                </Grid>
            </Border>
            
            <!-- Liste des conversations -->
            <ScrollView Grid.Row="1"
                        MaximumHeightRequest="500">
                
                <VerticalStackLayout x:Name="ConversationsList"
                                     Spacing="0"
                                     Padding="0">
                    
                    <!-- Empty view si aucune conversation -->
                    <Grid x:Name="EmptyView"
                          MinimumHeightRequest="300"
                          IsVisible="False">
                        <VerticalStackLayout Spacing="12"
                                             HorizontalOptions="Center"
                                             VerticalOptions="Center">
                            <Label Text="ðŸ’­"
                                   FontSize="48"
                                   HorizontalOptions="Center"
                                   Opacity="0.3"/>
                            <Label Text="Aucune conversation"
                                   FontSize="16"
                                   TextColor="{DynamicResource SecondaryTextColor}"
                                   HorizontalOptions="Center"/>
                        </VerticalStackLayout>
                    </Grid>
                </VerticalStackLayout>
            </ScrollView>
            
            <!-- Footer -->
            <Border Grid.Row="2"
                    BackgroundColor="{DynamicResource PageBackgroundColor}"
                    Padding="16,12"
                    StrokeShape="RoundRectangle 0,0,12,12"
                    StrokeThickness="0"
                    Stroke="{DynamicResource BorderColor}">
                <HorizontalStackLayout HorizontalOptions="Center" VerticalOptions="Center">
                <Button Text="Effacer tout"
                        FontSize="13"
                        TextColor="{DynamicResource PrimaryTextColor}"
                        BackgroundColor="Transparent"
                        HorizontalOptions="Center"
                        Clicked="OnClearAllClicked"/>
                <Button Text="Voir tout"
                            FontSize="12"
                            TextColor="{DynamicResource PrimaryTextColor}"
                            BackgroundColor="Transparent"
                            Padding="8,4"
                            Margin="0,0,1,0"
                            IsVisible="True"/>
                    </HorizontalStackLayout>
            </Border>
        </Grid>
    </Border>
</ContentView>
